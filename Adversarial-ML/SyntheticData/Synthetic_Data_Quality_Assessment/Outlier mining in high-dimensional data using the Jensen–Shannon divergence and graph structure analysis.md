## Abstract

Reliable anomaly/outlier detection algorithms have practical applications in many fields. For instance, anomaly detection allows to filter and clean the data used to train machine learning algorithms, improving their performance. However, outlier mining is challenging when the data is high-dimensional, and different approaches have been proposed for different types of data (temporal, spatial, network, etc). Here we propose a methodology to mine outliers in generic datasets in which it is possible to define a meaningful distance between elements of the dataset. The methodology is based on defining a fully connected, undirected graph, where the nodes are the elements of the dataset and the links have weights that are the distances between the nodes. Outlier scores are defined by analyzing the structure of the graph, in particular, by using the Jensen–Shannon (JS) divergence to compare the distributions of weights of different nodes. We demonstrate the method using a publicly available database of credit-card transactions, where some of the transactions are labeled as frauds. We compare with the performance obtained when using Euclidean distances and graph percolation, and show that the JS divergence leads to performance improvement, but increases the computational cost.

## 1. Introduction

The terms anomaly and outlier generally refer to observations of a give process that seems to be generated by a mechanism that is not the one that governs the process. While outliers and anomalies are often used as synonymous, they have also been distinguished in the following terms: an outlier is a legitimate data point that is far from the center of a distribution that characterizes a process, and an anomaly is a data point that cannot be explained given current knowledge of the process generating the data. Anomalies have been classified in three types: point anomalies (a data point that is anomalous with respect to the rest of the data), contextual anomalies (a data point that is anomalous in a specific context) and collective anomalies (a set of data points that are not anomalies by themselves, but their collective occurrence is anomalous) [[1](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib1)].

The identification of these observations is important for different purposes (failure detection, novelty detection, intruder detection, etc), and in particular, in the context of artificial intelligence systems, to clean the data used for training the algorithms.

Many methods for outlier detection have been proposed in the literature (see, e.g. [[2](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib2)–[6](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib6)] and references therein), some of them, based on distances that can be computed between elements of the dataset [[7](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib7)–[11](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib11)]. In outlier detection via graph methods, distance-based outlier mining is based on a fully connected graph structure in which the nodes represent the elements of the dataset and the connections between them are quantified by a distance measure. In this sense, with _N_ elements in the dataset, each with a _M_-dimensional vector of features, ![$f_i = \{f_{i1}, f_{i2}, \ldots f_{iM}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn1.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=zX6Q7G2LMSBWlepcf6R4YPb6Myw%3D) ![$i = 1\ldots N$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn2.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=f1uUovji2Xown5K0zt%2BS6fnhMdY%3D), by using an appropriate distance to quantify differences in the vectors of features, one obtains a _N_ **×** _N_ distance matrix, where the vector of distances of node _i_, ![$d_i = \{d_{i1}, d_{i2}, \ldots d_{iN}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn3.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=57C1REicrJqfWqbcUTwpa7k0ea0%3D), can be considered a new set of features that can be used for training a binary classification algorithm (outlier/normal element). In large datasets the new feature vector is very long and this approach becomes computationally demanding. An alternative approach is to use a dimensionality-reduction strategy and extract informative features from the vectors of distances. In this work we show that the average distance and the shape of the distance distribution can be used for outlier mining.

A popular measure for comparing different distributions is the Jensen–Shannon (JS) divergence [[12](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib12)]. We define new outlier scores (OSs) using the JS divergence computed from the distributions of Euclidean distances between nodes. The method does not have any free parameter and thus, it does not require training. We demonstrate the method using a publicly available database of credit-card transactions where some of the transactions are labeled as frauds [[13](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib13), [14](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib14)]. We quantify the performance with well-known measures, the area under the curve receiver operating characteristic (AUC-ROC) and the area under the curve precision recall (AUC-PR) [[15](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib15), [16](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib16)]. We also compare with the performance of the 'graph-percolation' method proposed in [[10](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib10)], which is also parameter-free. In the percolation method, the links with longest distances are gradually removed, and an OS is assigned to each element, in the order in which the elements become disconnected from the giant component.

The work is organized as follows. Section [2](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94as2) describes the proposed methodology, section [3](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94as3) describes the dataset used, section [4](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94as4) describes the performance quantifiers, section [5](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94as5) presents the results and section [6](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94as6) presents the discussion and the conclusions.

## 2. Method

We consider a set of _N_ elements (nodes) which have associated vectors with _M_ features (for the credit card database to be described in the next section, _M_ = 28). The Euclidean distance between two elements, _i_ and _j_, whose feature vectors are ![$\{{f_{i1} \ldots f_{iM}}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn4.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=qPfu2pFM6HuOVLiZ2bSfTZIxQCA%3D) and ![$\{{f_{j1} \ldots f_{jM}}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn5.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=Z429wqWbrZiN54MBl5lJxeAlZsc%3D) is:

![Equation (1)](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aeqn1.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=TQeB3atvH5%2BpEZ7cRl5FOi7RvfA%3D)

With the vector of distances of node _i_, ![$d_i = \{d_{i1}, d_{i2}, \ldots d_{iN}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn6.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=4BMJ99Vi1s4Dr2SCAwdKVjtsnUA%3D), we define the first 'outlier score' of node _i_, OS1_i_ as the average distance,

![Equation (2)](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aeqn2.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=ECZ3v8Cjs4qYt3sIQbMkziKu8Qw%3D)

Elements that have high values of OS1 have, on average, large distances to other nodes.

More information can be obtained by inspecting not the average, but the shape of the distribution of distances. Given two nodes _i_ and _j_, if the shape of the distributions of Euclidean distances ![$\{d_{il}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn7.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=1d0m5AqPER%2BxOBhc%2FJDHLex0T%2FU%3D) and ![$\{d_{jl}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn8.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=JqO0MHG3EVTrtndGEYgeG7Wg9Ws%3D) (with ![$l = 1\ldots N$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn9.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=1rZao0MuaH57NnZjvM8q1yZOSWw%3D)) is similar, then the elements can be considered similar, else, they are different. Therefore, a weight can be assigned to the link between nodes _i_ and _j_ by calculating the distance between the distributions of ![$\{d_{il}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn10.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=qEWvuW7OOMYG%2Fhsm60bWie9tdnM%3D) and ![$\{d_{jl}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn11.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=6y1A9v765cQ8Oz8h9fzdG9XQEGM%3D) values, _P__i_ and _P__j_ respectively. Different distance measures can be used to compare two distributions and here we use the popular JS divergence,

![Equation (3)](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aeqn3.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=J5iBxCjFJL7PjUUxQQf1fsYMe9k%3D)

where the Shannon entropy, ![$H[P]$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn12.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=p84IMW%2FJfpUL4%2FO3%2BuVIzVaEAcQ%3D), is defined as follows [[17](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib17)]: given a discrete random variable _X_ which takes values in the alphabet Ξ and is distributed according to _p_ : ![$\Xi \rightarrow [0,1]$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn13.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=zi379raQIVovg2cSKqQx12TupwU%3D),

![Equation (4)](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aeqn4.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=ZlM6vFkLczkYzNfUlTs1c4sKeOE%3D)

If the distribution is estimated from an histogram with _L_ bins, then ![$H[P] = -\sum_{m = 1}^L p_m \log p_m$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn14.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=BOvMU0EyFodmKOa1gsbD2tA1QXg%3D) with ![$\sum_{m = 1}^L p_m = 1$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn15.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=zOlnubo9hyf4C4ImxAEADue054k%3D). We have written the algorithm in _python_ and used the 'euclidean' library to calculate the Euclidean distances and the 'jensenshannon' library to calculate the JS divergence [[18](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib18)].

Then, with the new vector of distances of node _i_, ![$D_i = \{D_{i1}, D_{i2}, \dots D_{iN}\}$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn16.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=pthSrAKtabMpcjZDW57DcAUGTCY%3D), we repeat the procedure and calculate a second OS of node _i_ as the average distance:

![Equation (5)](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aeqn5.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=3D2lV86a9zdRNB42Pb5%2BB91cOag%3D)

In addition, we calculate OSs using the graph percolation procedure proposed in [[10](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib10)]. In this procedure, the connections with longest distances are removed one by one, and an OS is assigned to each element, in the order in which the element becomes disconnected from the giant component. For example, if node number 3 is the first node to become disconnected from the giant component, and then nodes 5 and 11 become disconnected, then, node number 3 is assigned an OS ![$\mathrm {OP} = 1$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn17.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=1YC%2F6sFklJCsJ0FNawVJieV5hTs%3D), node number 5 is assigned ![$\mathrm {OP} = 2$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn18.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=%2Be249caBUy9zcT7%2B9mq5GsBYK70%3D) and node number 11, ![$\mathrm {OP} = 3$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn19.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=Ou8U8jS8N2RNZwYbvNBBd8tiiNg%3D) (a video showing an example is available in [[10](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib10)], supplementary information). We refer to the OSs defined in this way, as OP1 when using Euclidean distances and as OP2, when using JS divergences.

The whole procedure is schematically summarized in figure [1](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af1): we start with the _N_ **×** _N_ matrix of Euclidean distances (_d_). Using this matrix, we define OS1 as the average Euclidean distance to all the other nodes and OP1 is the order in which is disconnected from the giant component. Through the probability distributions obtained from the values of distances for each node, the JS divergence is computed for each pair of nodes, and a new _N_ **×** _N_ distance matrix is obtained (_D_). With this matrix, we define OS2 as the average JS divergence, and OP2 is the order in which the element becomes disconnected from the giant component, when using JS divergences.



![[Pasted image 20230406110055.png]]

**Figure 1.** Schematic representation of the procedure for assigning outlier scores (OS) to elements of a database that are represented by network nodes. OS1 and OS2 are defined in equations ([2](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94aeqn2)) and ([5](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94aeqn5)), OP1 and OP2 refer to the order in which a node becomes disconnected from the giant component, as the longest links are removed one by one, when using Euclidean distances (OP1) or when using JS divergences (OP2).

## 3. Data

The dataset used in this study represents 284 807 European credit card transactions carried out in two days in September 2013 [[14](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib14)]. Transactions are anonymous and labeled in two classes: fraud (1) or non-fraud (0). The dataset is very unbalanced, with 492 frauds and 284 315 non-frauds, where frauds represent only 0.172% of the dataset. The dataset is anonymized by a principal component analysis with 28 dimensions.

The data structure contains 31 numeric attributes. The 'Time' defines the seconds between transactions and the first transaction. The 'Amount' defines the value associated with each transaction. The 'Class' attribute specifies the prevision of transactions, where the value 1 represents fraud, and the value 0 represents non-fraud. The other 28 attributes have values taken from PCA.

In [[10](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib10)] no improvement in average precision was found when including the attributes 'Time' and 'Amount' in the feature set and therefore, here we only use the 28 PCA features in the analysis.

## 4. Performance measures

As important as selecting data attributes (features) to mine outliers is selecting an appropriate performance measure. Two well-known measures are the AUC-ROC and the AUC-PR [[15](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib15), [16](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib16)].

The curves are obtained by varying the classification threshold and calculating the

-   (a) True positives (TP): number of elements that are correctly detected as outliers.
    
-   (b)  True negatives (TN): number of elements that are correctly detected as normal.
    
-   (c)  False positives (FP): number of elements that are incorrectly detected as outliers.
    
-   (d)  False negatives (FN): number of elements that are incorrectly detected as normal.
    

Then, the true positive rate (TPR, also known as _recall_) is TP/(TP+FN) = TP/(# of outliers), and the false positive rate (FPR) is FP/(TN+FP) = FP/(# of normal elements). The ROC curve is obtained by plotting the TPR vs. FPR.

The area under the ROC curve is a measure of the goodness of a binary classifier: while random guessing gives a diagonal line, a perfect classifier has one (or more) thresholds that perfectly separate the two classes. In this situation, AUC-ROC = 1.

ROC curves can present a very optimistic view of a classifier performance if there is a significant class unbalance and in this case PR curves have been used as an alternative to ROC curves [[15](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib15), [16](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib16)]. The PR curve is more informative because it does not depend on the number of true negatives. The _precision_ is the ratio of correct positive detections over all positive detections, TP/(TP+FP), and the PR curve is obtained by plotting the precision vs. the recall (i.e. the TPR). The _average precision_ is the area under the PR curve (AUC-PR).

## 5. Results

Figure [2](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af2) displays the ROC and PR curves obtained with the four OSs, considering datasets with different sizes. In all cases, the elements of the datasets were selected such that 10% were fraud transactions and 90% were regular ones. We note that OS1 and OS2 have very similar performance, which is higher than the performance of OP1 and OP2. In [[10](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib10)] the average performance achieved with the percolation method was lower than 0.6, while here, the performance of OS1 and OS2 typically exceed 0.8. We have verified that the value of AUC-PR remains similar when a smaller number of outliers is included in the dataset (figure [3](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af3)).
![[Pasted image 20230406110257.png]]

**Figure 2.** Receiver operating characteristic (left column) and precision-recall curve (right column) obtained for the four outlier scores analyzed, using 200 networks with 10% fraud and 90% no fraud. Network sizes: _N_ = 100 (top row), _N_ = 1000 (bottom row).

![[Pasted image 20230406110348.png]]**Figure 3.** As figure [2](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af2), but with 5% fraud and 95% no fraud.

Results with different _N_ are summarized in table [1](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94at1), where it can be seen that OS1 and OS2 clearly outperform the percolation-based methods, OP1 and OP2. However, one might wonder if this increase in performance does not require a high increase of the computational time. Figure [4](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af4) shows that, as could be expected, for the four methods the computational time increases as ![$\propto N^2$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn20.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=Vc42hSCBIGsSVkenP%2FLvKRgrtPc%3D) due to the calculation of the _N_ **×** _N_ distance matrix. Figure [4](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af4) indicates some typical times when the algorithm was run on a iMac core i7 computer with 64 GB RAM.

![[Pasted image 20230406110512.png]]

**Figure 4.** Computational time as a function of the network size. The linear relation is consistent with the fact that the number of operations grows a ![$\propto N^2$](https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/2632-072X/3/4/045011/revision2/jpcomplexaca94aieqn21.gif?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1681376042&Signature=4f%2BGVeg%2BvRrTvahbxWFRlTwzX%2FE%3D). Methods OS2 and OP2 require consistently more time, as the JS matrix needs to be calculated from the Euclidean matrix.

![[Pasted image 20230406110902.png]]
In table [1](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94at1) we also notice that for OP1, the mean of the AUC-PR seems to decrease and then seems to saturate as _N_ increases. We do not yet know the origin of this variation, and to determine whether is generic or is specific to the dataset analyzed, additional studies, using other datasets, are planned.

Taken together, the results presented in table [1](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94at1) and figure [4](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94af4) show that OS1 is a cost-effective method for mining outliers in this dataset, because it has a performance that is only slightly lower than OS2, while it avoids the calculation of the matrix of JS divergences, which is computationally demanding when the datasets are large.

We remark that detecting credit card frauds is an active research field, and the publicly available dataset that we have used [[13](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib13), [14](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib14)], has been used by other authors. A natural next step is to perform a critical comparison with other techniques; however, this is left for future work as our goal here is to present a general method that can be used to mine outliers in generic datasets, whenever appropriate distances can be defined between elements of the datasets. We use the credit card database just as an example, and we do not claim that our method outperforms other methods for detecting credit card frauds.

## 6. Conclusion

We have proposed a new methodology for mining outliers in high-dimensional datasets. The method is based in the analysis of the fully connected graph, where the distances between the elements of the dataset are defined by using the Euclidean or the JS divergence. At least for the dataset analyzed we conclude that the analysis of the average distance improves precision, with respect to the graph percolation method proposed in [[10](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib10)]. Future work will be devoted to test these methods in databases of crime occurrences in Minas Gerais, Brazil [[19](https://iopscience.iop.org/article/10.1088/2632-072X/aca94a#jpcomplexaca94abib19)].

As the JS divergence complements the information obtained from the mean Euclidean distances (because it compares the _shape_ of two distributions), we speculate that combining OS1 and OS2 can further improve performance. Another way in which the method can be refined is by replacing the (parameter-free) Euclidean distance with a functional form whose parameters can be optimally tuned to the data that is analyzed. The method proposed here is parameter-free and therefore, the algorithm does not require any training; however, a functional form can be used instead of the Euclidean distance, and its parameters can be optimally tuned to the particular data under inspection, by using machine learning. For example, weights can be assigned to different features, to pay particular attention to the most informative ones.